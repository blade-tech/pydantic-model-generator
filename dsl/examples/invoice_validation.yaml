outcome_name: "Invoice Approval Validation"
context_summary: "Validate that invoices can be approved only when: invoice amount <= budget AND vendor is approved AND has valid purchase order"

required_evidence:
  - name: Budget
    description: "Department budget limits"
    must_have_slots:
      - department_id
      - amount_limit

  - name: ApprovedVendor
    description: "List of approved vendors"
    must_have_slots:
      - vendor_id
      - vendor_name
      - approval_status

queries_we_must_answer:
  - "Can this invoice be approved? (must check: amount <= budget AND vendor approved AND has PO)"
  - "Which invoices are blocked and why?"
  - "What is the total pending amount per department?"

target_entities:
  - name: Invoice
    description: "Invoice requiring approval"
    must_have_slots:
      - invoice_id
      - department_id
      - vendor_id
      - amount
      - has_purchase_order

  - name: ApprovalDecision
    description: "The approval decision with reason"
    must_have_slots:
      - invoice_id
      - can_approve
      - reason

relations:
  - name: WithinBudget
    subject: Invoice
    object: Budget
    description: "Invoice amount within department budget"

  - name: FromVendor
    subject: Invoice
    object: ApprovedVendor
    description: "Invoice from this vendor"

  - name: HasDecision
    subject: Invoice
    object: ApprovalDecision
    description: "Invoice has approval decision"

ontologies:
  - prefix: fibo
    base_uri: "https://spec.edmcouncil.org/fibo/ontology/"
    include_classes: []

graphiti_constraints:
  use_entity_type_metadata: true
  edge_names_pascal_case: true
  stamp_uri_on_edges: true
