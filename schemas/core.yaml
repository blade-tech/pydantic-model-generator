id: https://example.org/graphmodels/core
name: graphmodels_core
description: |
  Core LinkML schema providing foundational mixins for provenance,
  identification, and metadata stamping for Graphiti compatibility.

  All generated schemas MUST import this to ensure:
  - Unique identification (node_id, rel_id)
  - Entity type metadata (for Graphiti label workaround)
  - Provenance tracking (files, revisions, text hashes, permalinks)
  - Support counting and derivation tracking

prefixes:
  gm: https://example.org/graphmodels/core/
  linkml: https://w3id.org/linkml/

default_prefix: gm

types:
  string:
    base: str
    uri: xsd:string
  integer:
    base: int
    uri: xsd:integer
  boolean:
    base: bool
    uri: xsd:boolean
  float:
    base: float
    uri: xsd:float
  datetime:
    base: datetime
    uri: xsd:dateTime

slots:
  # Core identification
  node_id:
    range: string
    required: true
    identifier: true
    description: Unique identifier for a node

  rel_id:
    range: string
    required: true
    identifier: true
    description: Unique identifier for a relationship/edge

  relation_type:
    range: string
    required: true
    description: Type of relationship/edge (e.g., 'Requires', 'Fulfills', 'BlockedBy')

  uri:
    range: string
    description: Canonical URI/IRI for this entity or relationship

  # Entity type metadata (Graphiti workaround)
  entity_type:
    range: string
    required: true
    description: |
      Business/logical entity type (e.g., 'Document', 'Allocation', 'Rule').
      Since Graphiti uses generic labels, we preserve classification here.

  # Provenance slots
  prov_system:
    range: string
    description: Source system (e.g., 'slack', 'aaoifi', 'confluence')

  prov_file_ids:
    range: string
    multivalued: true
    description: Source file identifiers

  prov_rev_ids:
    range: string
    multivalued: true
    description: Revision/version identifiers

  prov_text_sha1s:
    range: string
    multivalued: true
    description: SHA1 hashes of source text for deduplication

  prov_permalinks:
    range: string
    multivalued: true
    description: Permanent links to source documents/messages

  doc_paths:
    range: string
    multivalued: true
    description: Document paths or locations

  page_nums:
    range: integer
    multivalued: true
    description: Page numbers where this content appears

  support_count:
    range: integer
    description: Number of supporting evidence pieces

  # Derivation tracking
  derived:
    range: boolean
    description: Whether this entity/edge was derived vs directly extracted

  derivation_rule:
    range: string
    description: Rule or logic used to derive this entity/edge

classes:
  NodeProv:
    mixin: true
    description: |
      Mixin providing provenance and identification for graph nodes.
      Every entity class should include this mixin.
    slots:
      - node_id
      - uri
      - entity_type
      - prov_system
      - prov_file_ids
      - prov_rev_ids
      - prov_text_sha1s
      - prov_permalinks
      - doc_paths
      - page_nums
      - support_count

  EdgeProv:
    mixin: true
    description: |
      Mixin providing provenance and identification for graph edges/relationships.
      Every association should include this mixin.
    slots:
      - rel_id
      - relation_type
      - uri
      - derived
      - derivation_rule
      - prov_system
      - prov_file_ids
      - prov_rev_ids
      - prov_text_sha1s
      - support_count
